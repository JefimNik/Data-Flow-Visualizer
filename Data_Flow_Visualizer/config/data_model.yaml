version: 1.2
author: Jefim
description: Пример модели данных для Data Flow Visualizer
nodes:
- name: Catalog_input
  layer: SharePoint
  type: Excel
  comment: Основной справочник материалов и узлов для проекта.
  columns:
  - name: LOT6
    type: TEXT
    description: Код сборочной партии (LOT)
    comment: Основное поле для объединения данных
  - name: MFZ2
    type: TEXT
    description: Код монтажной зоны
    comment: Используется для группировки деталей
  - name: '4'
    type: Number10
    description: Тип материала
    comment: Поле из ERP каталога
  - name: Supplier
    type: TEXT
    description: Поставщик
    comment: Указывается при импорте каталога
- name: Saved_progress
  layer: SharePoint
  type: Excel
  comment: Статусы выполнения работ по сборочным зонам.
  columns:
  - name: LOT
    type: TEXT
    description: Код сборочной партии
    comment: Связан с Catalog_input.LOT
  - name: Progress_Status
    type: TEXT
    description: Статус выполнения
    comment: 'Например: ''In progress'', ''Done'''
  - name: Updated_On
    type: DATE
    description: Дата обновления статуса
    comment: Автоматически из SharePoint
- name: Work_Hours
  layer: SharePoint
  type: Excel
  comment: Учёт рабочих часов по LOT и зонам.
  columns:
  - name: LOT4
    type: TEXT
    description: Идентификатор партии
    comment: Ключ для объединения
  - name: Employee_ID
    type: TEXT
    description: Код работника
    comment: Уникальный идентификатор сотрудника
  - name: Hours
    type: FLOAT
    description: Количество часов
    comment: Указывается вручную или из WMS
  - name: Updated_On
    type: DATE
    description: Дата учёта
    comment: Дата фиксации рабочих часов
- name: Merged_Spool_Data
  layer: PowerQuery
  type: Table
  comment: Объединённая таблица с материалами, статусами и часами.
  columns:
  - name: LOT
    type: TEXT
    description: Ключ LOT
    comment: Импортировано из Catalog_input
  - name: MFZ
    type: TEXT
    description: Код сборочной зоны
    comment: Импортировано из Catalog_input
  - name: Progress_Status
    type: TEXT
    description: Статус выполнения
    comment: Из Saved_progress
  - name: Hours
    type: FLOAT
    description: Фактическое количество часов
    comment: Из Work_Hours
  - name: Weight
    type: FLOAT
    description: Вес сборки
    comment: Вычисляется автоматически в PQ
- name: Transfer_Orders
  layer: Output
  type: Report
  comment: Финальный отчёт с данными о партиях, статусах и трудозатратах.
  columns:
  - name: LOT
    type: TEXT
    description: Ключ сборки
    comment: Из Merged_Spool_Data.LOT
  - name: Warehouse
    type: TEXT
    description: Склад
    comment: Заполняется вручную
  - name: Progress_Status
    type: TEXT
    description: Статус
    comment: Из Saved_progress
  - name: Total_Hours
    type: FLOAT
    description: Общее количество часов
    comment: Агрегируется из Work_Hours
  - name: Weight
    type: FLOAT
    description: Вес
    comment: Из Merged_Spool_Data.Weight
edges:
- from: Catalog_input
  to: Merged_Spool_Data
  transfer_type: pq
  data_type: materials
  transfer:
  - - LOT
    - LOT → Merged_Spool_Data.LOT
  - - MFZ
    - MFZ → Merged_Spool_Data.MFZ
- from: Saved_progress
  to: Merged_Spool_Data
  transfer_type: pq
  data_type: progress
  transfer:
  - - Progress_Status
    - Progress_Status → Merged_Spool_Data.Progress_Status
- from: Work_Hours
  to: Merged_Spool_Data
  transfer_type: pq
  data_type: hours
  transfer:
  - - LOT
    - LOT → Merged_Spool_Data.LOT
  - - Hours
    - Hours → Merged_Spool_Data.Hours
- from: Merged_Spool_Data
  to: Transfer_Orders
  transfer_type: manual
  data_type: cost
  transfer:
  - - LOT
    - LOT → Transfer_Orders.LOT
  - - Warehouse
    - Warehouse → Transfer_Orders.Warehouse
- from: Saved_progress
  to: Transfer_Orders
  transfer_type: planned
  data_type: documents
  transfer:
  - - Progress_Status
    - Progress_Status → Transfer_Orders.Progress_Status
- from: Work_Hours
  to: Transfer_Orders
  transfer_type: pq
  data_type: workers
  transfer:
  - - Employee_ID
    - Employee_ID → Transfer_Orders.Total_Hours
